{% extends 'base_crud_dynamic.html' %}
{% load custom_filters %}

{% block content %}
<h1>Carrito de Compras</h1>

{% if cart %}
<table class="table table-striped table-bordered">
    <thead>
        <tr>
            <th>Nombre del Producto</th>
            <th>Precio</th>
            <th>Cantidad</th>
            <th>Total</th>
            <th>Acci√≥n</th>
        </tr>
    </thead>
    <tbody>
        {% for item in cart %}
        <tr>
            <td>{{ item.name }}</td>
            <td>${{ item.price }}</td>
            <td>
                <input type="number" name="quantity_{{ forloop.counter0 }}" value="{{ item.quantity }}" min="1" max="{{ item.stock }}">
            </td>
            <td>${{ item.price|multiply:item.quantity }}</td>
            <td>
                <form method="post" action="{% url 'remove_from_cart' forloop.counter0 %}" class="d-inline">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger btn-sm">Eliminar</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
    <tfoot>
        <tr>
            <td colspan="3">Total</td>
            <td>${{ total}}</td>
            <td><form method="POST" action="{% url 'buy_products' %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-success">Comprar</button>
                <a href="{% url 'clear_cart' %}" class="btn btn-warning">Limpiar Carrito</a>
            </form>
            </td>
        </tr>
    </tfoot>
</table>




{% else %}
<p>No hay productos en el carrito.</p>
{% endif %}
{% endblock %}
